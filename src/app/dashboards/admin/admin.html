<div class="otw-admin-shell">
  <!-- Sidebar -->
  <aside class="otw-admin-sidebar">
<div>
  <div class="otw-admin-brand-row">
    <div class="otw-admin-brand">
      <div class="otw-admin-logo"></div>
      <span class="otw-admin-brand-text">OTW</span>
    </div>

    <!-- Dropdown trigger -->
    <div class="otw-admin-user-dropdown" (click)="userMenuOpen = !userMenuOpen">
      <div class="otw-admin-user-circle">ADMIN</div>
      <span class="otw-admin-user-caret">â–¾</span>

      <!-- Dropdown menu -->
      <div class="otw-admin-user-menu" *ngIf="userMenuOpen">
        <button type="button" class="otw-user-menu-item" (click)="logout()">
          Logout
        </button>
      </div>
    </div>
  </div>

  <!-- Toggle buttons under logo -->
  <div class="otw-admin-toggle">
    <button
      class="otw-toggle-btn"
      [class.active]="activeSection === 'drivers'"
      (click)="showDrivers()">
      Driver Accounts
    </button>
    <button
      class="otw-toggle-btn"
      [class.active]="activeSection === 'commuters'"
      (click)="showCommuters()">
      Commuter Accounts
    </button>
  </div>
</div>


  </aside>

  <!-- Main content -->
  <main class="otw-admin-content">
    <!-- Summary row -->
    <section class="otw-admin-summary">
      <div class="otw-summary-card">
        <span class="otw-summary-label">Drivers</span>
        <span class="otw-summary-value">{{ drivers().length }}</span>
      </div>
      <div class="otw-summary-card">
        <span class="otw-summary-label">Commuters</span>
        <span class="otw-summary-value">{{ commuters().length }}</span>
      </div>
      <button
        type="button"
        class="otw-summary-card otw-summary-cta"
        routerLink="/admin/dashboard/add-driver">
        <span class="otw-summary-value">+ Add Driver</span>
      </button>
    </section>

    <!-- Drivers section -->
    <section class="otw-section" *ngIf="activeSection === 'drivers'">
      <div class="otw-section-header">
        <h1>Driver Accounts</h1>
        <div class="otw-search-container">
          <input 
            type="text" 
            [(ngModel)]="driverSearchTerm" 
            (input)="filterDrivers()"
            placeholder="Search drivers..."
            class="form-control otw-search-input"
          >
        </div>
      </div>

      <div *ngIf="drivers().length === 0" class="otw-empty">
        No drivers found.
      </div>

      <div class="otw-list">
        <div *ngIf="filteredDrivers().length === 0" class="otw-empty">
          No drivers found matching your search.
        </div>
        <article class="otw-item-card" *ngFor="let d of filteredDrivers()">
          <!-- View -->
          <div *ngIf="editDriverId !== d.id" class="otw-item-row">
            <div class="otw-item-info">
              <h4>{{ d.name }}</h4>
              <p class="mb-1"><strong>Email:</strong> {{ d.email }}</p>
              <p class="mb-1"><strong>License:</strong> {{ d.license }}</p>
              <p class="mb-0"><strong>Plate:</strong> {{ d.plate }}</p>
            </div>
            <div class="otw-item-actions">
              <button class="btn btn-sm otw-btn-outline" (click)="startDriverEdit(d)">Update</button>
              <button class="btn btn-sm otw-btn-danger" (click)="deleteDriverAccount(d.id)">Delete</button>
            </div>
          </div>

          <!-- Edit -->
          <div *ngIf="editDriverId === d.id" class="otw-item-edit">
            <h5>Edit Driver</h5>
            <input class="form-control mb-2" [(ngModel)]="editDriverName" placeholder="Full Name">
            <input class="form-control mb-2" [(ngModel)]="editDriverEmail" placeholder="Email">
            <input class="form-control mb-2" [(ngModel)]="editDriverLicense" placeholder="License">
            <input class="form-control mb-2" [(ngModel)]="editDriverPlate" placeholder="Plate">
            <div class="text-end">
              <button class="btn btn-sm otw-btn-pill me-2"
                (click)="updateDriver(d.id, {
                  name: editDriverName,
                  email: editDriverEmail,
                  license: editDriverLicense,
                  plate: editDriverPlate
                })">
                Save
              </button>
              <button class="btn btn-sm btn-secondary" (click)="cancelDriverEdit()">Cancel</button>
            </div>
          </div>
        </article>
      </div>
    </section>

    <!-- Commuters section -->
    <section class="otw-section" *ngIf="activeSection === 'commuters'">
      <div class="otw-section-header">
        <h1>Commuter Accounts</h1>
      </div>

      <div *ngIf="commuters().length === 0" class="otw-empty">
        No commuters found.
      </div>

      <div class="otw-list">
        <article class="otw-item-card" *ngFor="let c of commuters()">
          <!-- View -->
          <div *ngIf="editId !== c.id" class="otw-item-row">
            <div class="otw-item-info">
              <h4>{{ c.name }}</h4>
              <p class="mb-1"><strong>Email:</strong> {{ c.email }}</p>
            </div>
            <div class="otw-item-actions">
              <button class="btn btn-sm otw-btn-outline" (click)="startEdit(c)">Update</button>
              <button class="btn btn-sm otw-btn-danger" (click)="deleteCommuter(c.id)">Delete</button>
            </div>
          </div>

          <!-- Edit -->
          <div *ngIf="editId === c.id" class="otw-item-edit">
            <h5>Edit Commuter</h5>
            <input class="form-control mb-2" [(ngModel)]="editCommuterName" placeholder="Full Name">
            <input class="form-control mb-2" [(ngModel)]="editCommuterEmail" placeholder="Email">
            <div class="text-end">
              <button class="btn btn-sm otw-btn-pill me-2"
                (click)="updateUser(c.id, { name: editCommuterName, email: editCommuterEmail })">
                Save
              </button>
              <button class="btn btn-sm btn-secondary" (click)="cancelEdit()">Cancel</button>
            </div>
          </div>
        </article>
      </div>
    </section>
  </main>
</div>
